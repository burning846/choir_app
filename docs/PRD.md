# 合唱团练习 App - 产品需求文档 (PRD)

## 1. 项目概述
### 1.1 背景
合唱团成员在日常排练之外需要大量个人练习时间。目前的痛点包括：乐谱（PDF）与范唱音频（MP3）分离，练习时需要来回切换；无法直观听到自己的演唱与伴奏的配合效果；缺乏指挥或声部长的有效反馈渠道。

### 1.2 目标
开发一款基于 Web 的轻量级练习应用（PWA），核心解决“看谱听音录音”的一体化体验。利用现有免费云资源部署，支持移动端使用，并为未来扩展为原生 App 预留架构空间。

## 2. 用户角色
*   **普通团员 (Singer):** 浏览乐谱、播放范唱、录音练习、回放自查、提交作业。
*   **指挥/声部长 (Conductor/Admin):** 上传乐谱与音频、管理曲目库、听取团员录音、发表评价。

## 3. 核心功能模块

### 3.1 认证与个人中心 (Authentication)
*   **功能:** 邮箱/手机号注册登录。
*   **需求:** 简单的身份验证，区分管理员与普通用户权限。
*   **扩展性:** 未来支持微信/第三方登录。

### 3.2 曲目库管理 (Library)
*   **功能:** 展示所有排练曲目列表。
*   **详情页:**
    *   **乐谱:** 集成 PDF 查看器。
    *   **音频:** 多音轨支持（如：钢琴伴奏、人声示范、分声部示范）。
*   **管理员操作:** 上传 PDF 文件、上传对应音频文件、设置曲目元数据（标题、作曲家）。

### 3.3 练习室 (Practice Studio) - **核心功能**
*   **界面布局:**
    *   **上方:** PDF 乐谱显示区域（支持缩放、翻页）。
    *   **下方:** 音频控制台与录音控制。
*   **音频播放:**
    *   播放/暂停/停止。
    *   **声部选择:** 能够单独开启/关闭特定音轨（例如：只听钢琴伴奏，或听钢琴+女高音示范）。
*   **录音功能:**
    *   点击“录音”按钮，同时播放选定的伴奏/示范音频。
    *   通过麦克风采集用户人声。
    *   录音过程中，波形图可视化反馈。
    *   **关键点:** 录音时必须解决回声消除（AEC）问题，或者提示用户佩戴耳机（推荐）。

### 3.4 回放与混音 (Review & Mix)
*   **功能:** 练习结束后，立即回放。
*   **混音调节:**
    *   用户可以调节“我的录音”与“伴奏音频”的音量比例。
    *   检查音准与节奏是否贴合。
*   **操作:** 保存录音（保存到云端或本地）、重新录制。

### 3.5 评价与反馈 (Evaluation)
*   **自我评价:** 用户可以给自己的录音打分或写备注。
*   **指挥评价:** 指挥在后台收听团员提交的录音，并在特定时间点（Timestamp）添加文字/语音评论。

## 4. 非功能性需求
*   **移动端适配:** 必须完美适配 iOS/Android 手机浏览器，采用响应式设计。
*   **离线能力:** 利用 Service Worker 缓存常用乐谱和音频，支持弱网环境练习（PWA 特性）。
*   **性能:** 音频加载延迟 < 1s，录音与伴奏同步误差 < 50ms。
*   **成本:** 初期构建及部署成本为 0（利用 Free Tier）。

## 5. 交互流程 (示例)
1.  团员登录 -> 进入曲目库 -> 选择《黄河大合唱》。
2.  加载 PDF 乐谱 -> 加载音频（默认开启伴奏+本声部）。
3.  点击“录音” -> 佩戴耳机 -> 跟唱。
4.  录音结束 -> 自动进入回放模式 -> 调节人声/伴奏比例 -> 确认满意。
5.  点击“提交作业” -> 上传至云端。

## 6. 未来规划 (Roadmap)
*   **Phase 1 (MVP):** Web 端实现核心录音与回放，基于 Supabase + Vercel 免费部署。
*   **Phase 2:** 增加指挥反馈系统，优化 PWA 离线体验。
*   **Phase 3:** 使用 Capacitor/React Native 打包为原生 App，增加即时通讯或社区功能。
